## $\texttt{Kaczmarz++}$
This is the public code repository for *Randomized Kaczmarz Methods with Beyond-Krylov Convergence* (<https://arxiv.org/abs/2501.11673>), a paper by Michał Dereziński, Elizaveta Rebrova, Deanna Needell and Jiaming Yang.
This repository contains Python code to recreate the paper's experiments, as well as the exact experimental data that generated our plots.
+ `kzpp_lsqr.py` and `kzpp_variants.py` correspond to the convergence testing experiments for $\texttt{Kaczmarz++}$ in Section 6.2 and Supplement 6.1. `kzpp_lsqr.py` tests the influence of computing the inner projection steps inexactly via sketch-and-preconditioned LSQR, `kzpp_variants.py` tests the effect of each individual components by comparing four variants of $\texttt{Kaczmarz++}$ (with/without acceleration, with/without block memoization). They generate Figure 1 and 2 in main paper, as well as Figure SM1 in supplement.
+ `psd_flops.py` corresponds to the comparison experiments between $\texttt{CD++}$ (PSD version of $\texttt{Kaczmarz++}$) and Krylov subspace methods (including CG and GMRES) in terms of FLOPs in Section 6.3 and Supplement 6.2. It also tests the effect of randomized Hadamard transform (RHT) on $\texttt{CD++}$. It generates Figure 3 in main paper, as well as Figure SM2 and Table SM1 in supplement.
+ `psd_regularization.py` corresponds to the regularization testing in projection experiments for $\texttt{CD++}$ in Supplement 4.3. It tests the effect of explicitly adding regularization to the projection step in $\texttt{Kaczmarz++}/\texttt{CD++}$, and generates Figure SM3 in supplement.

Each of the above four scripts contains the process of (1) load and preprocess datasets, (2) construct kernel matrices for real-world datasets (only for PSD cases), (3) set up linear systems and (4) solving linear systems using different variants of our method ($\texttt{Kaczmarz++}$ for general linear systems, $\texttt{CD++}$ for PSD linear systems) with comparison to Krylov-type methods (CG, GMRES). For the regeneration of plots, the code assume that all the `.npy` files, which contain the iteration information needed to compute the residual, are stored locally in the same directory as `kzpp_lsqr.py`, `kzpp_variants.py`, `psd_flops.py` and `psd_regularization.py`.

The implementation of different variants of $\texttt{Kaczmarz++}$ can be found in the `kaczmarz_plusplus` funtion under `kaczmarz.py`. In this function there are three Boolean variants with default values `accelerated=True`, `block=True` and `exact=False`, meaning the usage of *adaptive acceleration* and *block memoization*, and inexactly solving the inner projection step respectively. By setting the first two variants differently, the funtion recovers different solvers, as shown in Table 1 of the paper. The implementation of *fast symmetric Hadamard transform* can be found in the `symFHT` function under `utils.py`, which can be of independent interests.
